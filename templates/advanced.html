{% extends 'site_template.html' %}

{% block imports %}
    <link href="../static/css/my_css/search.css" rel="stylesheet">
{% endblock %}

{% block body %}
    {% with messages = get_flashed_messages() %}
    {% if messages %}
        {% for message in messages %}
         <div class="alert alert-danger" role="alert">
            {{ message }}
         </div>
        {% endfor %}
    {% endif %}
    {% endwith %}

     <form  id="search-form" action="/advanced/search" method="get">
        {% if not macro_collections() %}
        <div class="alert alert-info" role="alert">
            You don't have a collection to make queries. Create one <a href="/collection/register">here</a>.
        </div>
        {% else %}
            <center class="optionbox">
                    <select form="search-form" name="collection" class="form-control">
                        <option selected="selected" disabled> CHOOSE A COLLECTION </option>
                         {% for collection in macro_collections() %}
                            <option value="{{collection.id}}">
                               {{collection.name}}
                            </option>
                        {% endfor %}
                    </select>
            </center>
        {% endif %}
        <div id="page-wrapper-search-advanced">
            <div class="matchup-title-search">advanced search
            </div>
            <div class="container-fluid">
                <!-- Page Heading -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="input-group" id="adv-search">
                                        <center class="center-text-search">
                                            <input form="search-form" name="keywords" type="text" class="form-control input-text-search-advanced" placeholder="Search for snippets" />
                                            <div style="margin-top: 20px;" class="form-group col-md-12">
                                                <label style="color: #9C27B0;">ALGORITHM</label>
                                                <select form="search-form" name="algorithm" class="form-control" id="algorithm-select">
                                                  <option value="Boolean">Boolean</option>
                                                  <option value="Vector">Vector Space</option>
                                                  <option value="Probabilistic">Probabilistic</option>
                                                  <option value="ExtendedBoolean">Extended Boolean</option>
                                                </select>
                                            </div>
                                            <div id="weighting" hidden>
                                                <div style="margin-top: 20px;" class="form-group col-md-6">
                                                    <label style="color: #9C27B0;">TF</label>
                                                    <select name="tf" form="search-form" class="form-control" id="tf-select">
                                                      <option value="Binary">Binary</option>
                                                      <option value="TermFrequency">Term Frequency</option>
                                                      <option value="LogNormalization">Log Normalization</option>
                                                    </select>
                                                </div>
                                                <div style="margin-top: 20px;" class="form-group col-md-6">
                                                    <label style="color: #9C27B0;">IDF</label>
                                                    <select name="idf" form="search-form" class="form-control" id="idf-select">
                                                      <option value="Unary">Unary</option>
                                                      <option value="InverseFrequency">Inverse Frequency</option>
                                                      <option value="InverseFrequencySmooth">Inverse Frequency Smooth</option>
                                                      <option value="InverseFrequencyMax">Inverse Frequency Max</option>
                                                      <option value="ProbabilisticInverseFrequency">Probabilistic Inverse Frequency</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-12 from-group" id="hidden-p" hidden>
                                                <label style="color: #9C27B0;">P-VALUE: </label><input name="P" form="search-form" class="form-control" type="number" step="0.01" value="0">
                                            </div>
                                            <div style="margin-top: 10px;" class="col-md-12 form-group">
                                                <input type="submit" value="Search" class="btn btn-primary">
                                            </div>
                                        </center>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
     </form>

{% endblock %}

{% block footer %}
<script type="text/javascript">
    $('input').on("input", function(e) {
        $(this).val($(this).val().replace("/", ""));
    });
    $('#algorithm-select').change(function() {
        if($(this).val() === 'Boolean' || $(this).val() === 'Probabilistic'){
            $("#weighting").hide();
        }
        else{
            $("#weighting").show();
        }
        if ($(this).val() === 'ExtendedBoolean') {
            $("#hidden-p").show();
        }
        else {
            $("#hidden-p").hide();
        }
    });
</script>
{% endblock %}